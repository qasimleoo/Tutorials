Apache Tomcat, often referred to simply as Tomcat, is an open-source web server and servlet container developed by the Apache Software Foundation. It is one of the most popular Java-based web application servers used for deploying and running Java servlets and JavaServer Pages (JSP).

---------------------------------------
Real World Scenario
---------------------------------------
One real-world scenario where Apache Tomcat is commonly used is in the deployment of enterprise web applications. Let's consider an example of an e-commerce website.

------------
Development: The development team builds a Java-based e-commerce web application using servlets and JSPs. They use Apache Tomcat as the target runtime environment during development, allowing them to test and debug the application locally.

------------
Testing: Testers can deploy the application on a dedicated Tomcat server or use a shared Tomcat instance for testing purposes.

------------
Staging: After successful testing, the application moves to the staging environment, where it is deployed on a dedicated Tomcat server that closely resembles the production environment.

------------
Production Deployment: Once the application passes all the required tests and validations, it is ready for deployment to the production environment. In the production setup, Tomcat is configured to handle the incoming web requests and serve the dynamic content generated by the application.

------------
Scalability and Load Balancing: As the e-commerce website gains popularity and experiences increased traffic, the need for scalability arises. Tomcat's clustering and load balancing capabilities come into play. Multiple Tomcat instances are set up and configured in a cluster, and a load balancer is placed in front of them. The load balancer distributes incoming requests across the cluster, ensuring high availability, fault tolerance, and efficient utilization of server resources.

------------
Monitoring and Management: Tomcat's built-in monitoring and management features are utilized to monitor the performance and health of the production environment.

------------
Security: Tomcat provides various security mechanisms to protect the e-commerce website. It supports SSL/TLS encryption to secure data transmission between clients and the server.

In this real-world scenario, Apache Tomcat serves as the underlying web server and servlet container, providing a reliable and scalable platform for hosting the e-commerce website. Its features and capabilities ensure efficient deployment, management, and secure operation of the Java-based web application throughout its lifecycle.
------------------------------------------------------------------------


Commands To Setup:

##################----INSTALL TOMCAT----##################
cd /opt
sudo wget https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.65/bin/apache-tomcat-9.0.65.tar.gz
sudo tar -xvf apache-tomcat-9.0.65.tar.gz

cd /opt/apache-tomcat-9.0.65/conf
sudo vi tomcat-users.xml
# ---add-below-line at the end (2nd-last line)----
# <user username="admin" password="admin1234" roles="admin-gui, manager-gui"/>

sudo ln -s /opt/apache-tomcat-9.0.65/bin/startup.sh /usr/bin/startTomcat
sudo ln -s /opt/apache-tomcat-9.0.65/bin/shutdown.sh /usr/bin/stopTomcat

sudo vi /opt/apache-tomcat-9.0.65/webapps/manager/META-INF/context.xml

comment:
<!-- Valve className="org.apache.catalina.valves.RemoteAddrValve"
  allow="127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1" /> -->

sudo vi /opt/apache-tomcat-9.0.65/webapps/host-manager/META-INF/context.xml

comment:
<!-- Valve className="org.apache.catalina.valves.RemoteAddrValve"
  allow="127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1" /> -->


sudo stopTomcat
sudo startTomcat

Or use 
sudo systemctl stop tomcat
sudo systemctl start tomcat
sudo systemctl restart tomcat

sudo cp target/*.war /opt/apache-tomcat-9.0.65/webapps/




To change the port of an Apache Tomcat server, follow the steps below depending on your setup.

$TOMCAT_HOME/conf/server.xml
/opt/tomcat/conf/server.xml


Find the Connector section that looks like this:

<Connector port="8080" protocol="HTTP/1.1"
           connectionTimeout="20000"
           redirectPort="8443" />


Change the value of port to your desired port, for example 9090:

<Connector port="9090" protocol="HTTP/1.1"
           connectionTimeout="20000"
           redirectPort="8443" />


Restart Tomcat.



Change the Shutdown Port (Default 8005)

In the same server.xml file, find:

<Server port="8005" shutdown="SHUTDOWN">


You can change 8005 to any unused port, e.g.:

<Server port="9005" shutdown="SHUTDOWN">

Restart tomcat




Tomcat itself doesn’t have a setting like “allow multiple ports” in one connector — each port must be defined using a Connector in server.xml. You can, however, have Tomcat listen on multiple ports by adding multiple Connector entries. Here’s how:


1. Locate server.xml
$CATALINA_HOME/conf/server.xml

2. Add Multiple Connectors

By default, Tomcat has a single HTTP connector like:

<Connector port="8080" protocol="HTTP/1.1"
           connectionTimeout="20000"
           redirectPort="8443" />


To allow multiple ports (e.g., 8081, 9090), duplicate the connector with different ports:

<Connector port="8081" protocol="HTTP/1.1"
           connectionTimeout="20000"
           redirectPort="8443" />

<Connector port="9090" protocol="HTTP/1.1"
           connectionTimeout="20000"
           redirectPort="8443" />


Each connector can point to the same web applications.

Make sure each port is open in your firewall and not used by another service.


3. Open the Ports in Firewall (Ubuntu/UFW)
sudo ufw allow 8081/tcp
sudo ufw allow 9090/tcp
sudo ufw reload

4. Restart Tomcat
sudo systemctl restart tomcat



If you want different web apps on different ports in Tomcat, there are a few clean ways to do it. Tomcat doesn’t natively tie “ports → apps” except via Connectors + virtual hosts. Here’s how you can set it up:

1. Multiple Connectors + Multiple Hosts
You can create a Connector for each port and map it to a specific virtual host.

Example in server.xml:

<Connector port="8081" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8443" />
<Connector port="9090" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8443" />


Then define virtual hosts in the <Engine> section:

<Engine name="Catalina" defaultHost="localhost">

    <Host name="app1.local" appBase="webapps/app1" unpackWARs="true" autoDeploy="true">
    </Host>

    <Host name="app2.local" appBase="webapps/app2" unpackWARs="true" autoDeploy="true">
    </Host>

</Engine>




Single Tomcat, Two Connectors (Separate Ports)

Open conf/server.xml.

Add two <Connector> elements with different ports:

<Service name="Catalina">
    <Connector port="8080" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8443"/>
    <Connector port="9090" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8444"/>
    
    <Engine name="Catalina" defaultHost="localhost">
        <Host name="localhost" appBase="webapps">
            <Context path="" docBase="webapps/app1"/>
        </Host>
        <Host name="localhost2" appBase="webapps2">
            <Context path="" docBase="webapps2/app2"/>
        </Host>
    </Engine>
</Service>


Explanation:

webapps/app1 → accessible at http://localhost:8080/

webapps2/app2 → accessible at http://localhost:9090/

Setting path="" maps the app to the root of its port.

Important: You may need to create two <Engine> elements if you want full isolation, but most setups can manage with separate hosts.




Two <Host> elements under the same <Engine> trying to use path=""

Tomcat allows multiple <Host> elements under the same <Engine>.

But the default <Connector> only routes to the default host (the one in defaultHost="localhost").

Both <Host>s have a <Context> with path="". Even if Tomcat ignores the second host, defining a second root context under the same engine is not allowed and causes startup failure.

No connector mapping for second host/port

You have only one <Connector> (probably port 8080).

localhost2 does not have a connector pointing to it, so Tomcat doesn’t know how to serve it.

Tomcat does not automatically bind a host to a different port—you have to configure a new <Service> with a <Connector> and an <Engine> pointing to that host.

Correct approach for your use case

If you want:

app1 → 8080

app2 → 9090

You have two choices:

Option 1: Two <Service>s in server.xml (single Tomcat)

 <Service name="example1">
    <Connector port="8080" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8444"
            maxParameterCount="1000"
            maxThreads="3000"
               />
    <Engine name="example1" defaultHost="localhost">
      <Realm className="org.apache.catalina.realm.LockOutRealm">
        <!-- This Realm uses the UserDatabase configured in the global JNDI
             resources under the key "UserDatabase".  Any edits
             that are performed against this UserDatabase are immediately
             available for use by the Realm.  -->
        <Realm className="org.apache.catalina.realm.UserDatabaseRealm"
               resourceName="UserDatabase"/>
      </Realm>
      <Host name="localhost"  appBase="webapps1"
            unpackWARs="true" autoDeploy="true">
        <Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"
               prefix="localhost_access_log" suffix=".txt"
               pattern="%h %l %u %t &quot;%r&quot; %s %b %D" />
      </Host>
    </Engine>
  </Service>
  <Service name="example2">
    <Connector port="9090" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8444"
            maxParameterCount="1000"
            maxThreads="3000"
               />
    <Engine name="example2" defaultHost="localhost">
      <Realm className="org.apache.catalina.realm.LockOutRealm">
        <!-- This Realm uses the UserDatabase configured in the global JNDI
             resources under the key "UserDatabase".  Any edits
             that are performed against this UserDatabase are immediately
             available for use by the Realm.  -->
        <Realm className="org.apache.catalina.realm.UserDatabaseRealm"
               resourceName="UserDatabase"/>
      </Realm>
      <Host name="localhost"  appBase="webapps2"
            unpackWARs="true" autoDeploy="true">
        <Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"
               prefix="localhost_access_log" suffix=".txt"
               pattern="%h %l %u %t &quot;%r&quot; %s %b %D" />
      </Host>
    </Engine>
  </Service>


  